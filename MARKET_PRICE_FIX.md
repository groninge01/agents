# å¸‚åœºä»·æ ¼è·å–ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆï¼šSeahawks vs. Falcons å¸‚åœºçš„æ˜¾ç¤ºæ•°æ®ä¸å®˜ç½‘å®Œå…¨ç›¸å
- **å®˜ç½‘æ˜¾ç¤º**ï¼šä¹°äº† Falconsï¼Œä»·æ ¼ 25Â¢ï¼Œç°åœ¨å‡ ä¹å½’é›¶ï¼ŒæŸå¤± -$4.19 (-99.8%)
- **ç³»ç»Ÿæ˜¾ç¤º**ï¼šNo | $0.2500 | $0.9995 | ... | $+12.59 (+299.80%)

## ğŸ” æ ¹æœ¬åŸå› 

### é—®é¢˜ 1: ä»·æ ¼è·å–é”™è¯¯

åœ¨ `position_monitor.py` çš„ `get_current_price()` æ–¹æ³•ä¸­ï¼Œä½¿ç”¨ Gamma API ä½œä¸ºå¤‡ç”¨æ–¹æ³•æ—¶ï¼š

```python
# âŒ é”™è¯¯ï¼šæ€»æ˜¯è¿”å› prices[0]
prices = data[0].get('outcomePrices', [])
if prices and len(prices) > 0:
    return float(prices[0])  # é—®é¢˜ï¼šæ€»æ˜¯ç”¨ç¬¬ä¸€ä¸ªä»·æ ¼ï¼
```

**é—®é¢˜**ï¼šå¦‚æœç”¨æˆ·ä¹°äº† Falcons tokenï¼ˆå¯èƒ½æ˜¯ç¬¬äºŒä¸ª outcomeï¼‰ï¼Œä½†ç³»ç»Ÿæ€»æ˜¯è¿”å› `prices[0]`ï¼ˆç¬¬ä¸€ä¸ª outcome çš„ä»·æ ¼ï¼‰ï¼Œå¯¼è‡´ï¼š
- ç”¨æˆ·å®é™…æŒæœ‰ Falcons tokenï¼ˆä»·æ ¼æ¥è¿‘ 0ï¼‰
- ç³»ç»Ÿæ˜¾ç¤º Seahawks çš„ä»·æ ¼ï¼ˆæ¥è¿‘ 1.0ï¼‰
- ç»“æœï¼šæ˜¾ç¤ºå®Œå…¨ç›¸åï¼

### é—®é¢˜ 2: Token ID åˆ°ä»·æ ¼çš„æ˜ å°„

éœ€è¦æ ¹æ® `token_id` æ‰¾åˆ°å®ƒåœ¨ `clobTokenIds` åˆ—è¡¨ä¸­çš„ç´¢å¼•ï¼Œç„¶åè¿”å›å¯¹åº”çš„ `outcomePrices[index]` ä»·æ ¼ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®å¤ 1: æ ¹æ® Token ID è·å–æ­£ç¡®çš„ä»·æ ¼

ä¿®æ”¹ `get_current_price()` æ–¹æ³•ï¼Œæ ¹æ® token_id æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•ï¼š

```python
# âœ… æ­£ç¡®ï¼šæ ¹æ® token_id æ‰¾åˆ°å¯¹åº”çš„ä»·æ ¼ç´¢å¼•
token_ids_list = market.get('clobTokenIds', [])
prices = market.get('outcomePrices', [])

# æ‰¾åˆ° token_id åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•
token_idx = token_ids_list.index(token_id)
if token_idx < len(prices):
    return float(prices[token_idx])  # è¿”å›å¯¹åº”ç´¢å¼•çš„ä»·æ ¼
```

### ä¿®å¤ 2: ä¿å­˜å®é™…çš„æ–¹å‘åç§°

åœ¨ä¿å­˜æŒä»“æ—¶ï¼Œä¿å­˜å®é™…çš„æ–¹å‘åç§°ï¼ˆå¦‚ "Yes (Falcons)"ï¼‰ï¼Œè€Œä¸æ˜¯åªä¿å­˜ "Yes" æˆ– "No"ï¼š

```python
# ä¿å­˜ä¸º "Yes (Falcons)" æ ¼å¼
side_to_save = f"{t['side']} ({outcome_name})"
```

è¿™æ ·å¯ä»¥ï¼š
1. æ¸…æ¥šåœ°æ˜¾ç¤ºå®é™…è´­ä¹°çš„æ˜¯ä»€ä¹ˆ
2. ä¾¿äºè°ƒè¯•å’Œæ’æŸ¥é—®é¢˜
3. åœ¨æ˜¾ç¤ºæ—¶æ›´ç›´è§‚

## ğŸ”§ ä¿®æ”¹çš„æ–‡ä»¶

1. **`scripts/python/position_monitor.py`**
   - ä¿®å¤ `get_current_price()` æ–¹æ³•ï¼Œæ ¹æ® token_id æ­£ç¡®è·å–ä»·æ ¼

2. **`scripts/python/batch_trade.py`**
   - åœ¨ä¿å­˜æŒä»“æ—¶ï¼Œä¿å­˜å®é™…çš„æ–¹å‘åç§°ï¼ˆåŒ…å« outcome åç§°ï¼‰

## ğŸ“ éªŒè¯æ–¹æ³•

1. **æ£€æŸ¥æŒä»“è®°å½•**ï¼š
   - æ‰“å¼€ `scripts/python/positions.json`
   - æŸ¥çœ‹ `side` å­—æ®µï¼Œåº”è¯¥æ˜¾ç¤º "Yes (Falcons)" æˆ–ç±»ä¼¼æ ¼å¼

2. **æ£€æŸ¥ä»·æ ¼è®¡ç®—**ï¼š
   - è¿è¡Œ `python scripts/python/show_positions.py`
   - ä»·æ ¼åº”è¯¥ä¸å®˜ç½‘æ˜¾ç¤ºä¸€è‡´

3. **å¯¹æ¯”å®˜ç½‘**ï¼š
   - æ£€æŸ¥åŒä¸€æŒä»“åœ¨å®˜ç½‘å’Œç³»ç»Ÿä¸­çš„æ˜¾ç¤º
   - ä»·æ ¼å’Œç›ˆäºåº”è¯¥ä¸€è‡´

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ—§æŒä»“æ•°æ®**ï¼šä¹‹å‰ä¿å­˜çš„æŒä»“å¯èƒ½ä»ç„¶æ˜¾ç¤ºé”™è¯¯çš„æ–¹å‘ï¼Œéœ€è¦æ‰‹åŠ¨æ›´æ–°æˆ–é‡æ–°æ·»åŠ 

2. **ä»·æ ¼æ¥æºä¼˜å…ˆçº§**ï¼š
   - ä¼˜å…ˆä½¿ç”¨è®¢å•ç°¿ APIï¼ˆæ›´å‡†ç¡®ï¼‰
   - å¤‡ç”¨ Gamma APIï¼ˆå·²ä¿®å¤æ˜ å°„é—®é¢˜ï¼‰

3. **Token ID åŒ¹é…**ï¼šç¡®ä¿ `token_id` åœ¨ `clobTokenIds` åˆ—è¡¨ä¸­å¯ä»¥æ‰¾åˆ°ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºè­¦å‘Šå¹¶ä½¿ç”¨å¤‡ç”¨é€»è¾‘

## ğŸ¯ ä¸‹ä¸€æ­¥

1. æµ‹è¯•ä¿®å¤åçš„ä»£ç ï¼ŒéªŒè¯ä»·æ ¼æ˜¯å¦æ­£ç¡®
2. å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ä½¿ç”¨ `prices[0]` çš„åœ°æ–¹
3. è€ƒè™‘æ·»åŠ æ›´è¯¦ç»†çš„æ—¥å¿—ï¼Œè®°å½•ä»·æ ¼è·å–è¿‡ç¨‹





